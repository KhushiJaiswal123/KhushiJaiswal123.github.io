"0","# I will use 'glm' function but you can also use the 'caret' library."
"0","# Also I will not use any variable selection methods but I will leave this to you as exercise"
"0","bbc_logreg_Fit<-glm(formula=watched_in_Feb  ~Day+log_total_Time+log_number_of_shows , data = combined_train,family = ""binomial"")"
"0","summary(bbc_logreg_Fit)"
"1","
Call:
"
"1",""
"1","glm(formula = watched_in_Feb ~ Day + log_total_Time + log_number_of_shows, 
    family = ""binomial"", data = combined_train)"
"1",""
"1","
"
"1","
Coefficients:
"
"1","                   "
"1"," Estimate"
"1"," Std. Error"
"1"," z value"
"1"," Pr(>|z|)"
"1","    "
"1","
(Intercept)        "
"1"," -1.12401"
"1","    0.05269"
"1"," -21.331"
"1","  < 2e-16"
"1"," ***"
"1","
Day                "
"1","  0.06513"
"1","    0.06920"
"1","   0.941"
"1","    0.347"
"1","    "
"1","
log_total_Time     "
"1","  0.13283"
"1","    0.01823"
"1","   7.288"
"1"," 3.14e-13"
"1"," ***"
"1","
log_number_of_shows"
"1","  0.74091"
"1","    0.03926"
"1","  18.873"
"1","  < 2e-16"
"1"," ***"
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
(Dispersion parameter for "
"1",""
"1","binomial"
"1",""
"1"," family taken to be "
"1",""
"1","1"
"1",""
"1",")

"
"1",""
"1","    Null deviance: 9660.4  on 7012  degrees of freedom
"
"1",""
"1","Residual deviance: 7896.4  on 7009  degrees of freedom
"
"1","AIC: "
"1",""
"1","7904.4"
"1",""
"1","

"
"1",""
"1","Number of Fisher Scoring iterations: "
"1",""
"1","4"
"1",""
"1","
"
"1","
"
"0","# Next I predict the probabilities and then plot the ROC curve. "
"0","watched_prob<- bbc_logreg_Fit%>% predict(combined_test, type = ""response"")"
"0",""
"0",""
"0","library(pROC)"
"0","ROC_lr <- roc(combined_test$watched_in_Feb, watched_prob)"
"2","Setting levels: control = No, case = Yes
"
"2","Setting direction: controls < cases
"
"0","# Calculate the area under the curve (AUC)"
"0","AUC_lr<-round(auc(ROC_lr)*100, digits=2)"
"0","# Plot the ROC curve"
"0","ggroc(ROC_lr) + theme_bw()+ggtitle(paste(""LogReg BBC-Data AUC (validation) ="",AUC_lr,""%"",sep = """")) +"
"0","geom_segment(aes(x = 1, xend = 0, y = 0, yend = 1), color=""grey"", linetype=""dashed"")+geom_segment(aes(x = 1, xend = 1, y = 0, yend = 1), color=""black"", linetype=""dashed"")+geom_segment(aes(x = 1, xend = 0, y = 1, yend = 1), color=""black"", linetype=""dashed"")"
