"0","  "
"0","energy_long <-   energy |> "
"0","    select(1:2, 6:14) |> # we will now have 11 columns"
"0","    pivot_longer(cols = 3:11,"
"0","                 names_to = ""source"","
"0","                 values_to = ""value"") "
"0",""
"0",""
"0","top_fuel <- function(.source, .year, .n) {"
"0","  "
"0","  energy_long |> "
"0","    "
"0","    "
"0","    filter(year == .year,"
"0","           source == .source) |>"
"0","    drop_na(value) |> "
"0","    mutate(country  =  fct_reorder(country, value)) |>"
"0","    slice_max(order_by = value, n = .n) |>"
"0","    ggplot(aes(x = value, y = country)) +"
"0","    geom_col() +"
"0","    theme_minimal()+"
"0","    geom_text("
"0","      aes(label = scales::number(value, accuracy = 0.1), x = value - .25),"
"0","      colour = ""white"","
"0","      size = 4,"
"0","      hjust = 1"
"0","    ) +"
"0","    labs("
"0","      title = paste0(""Top "",.n,"" "", .source, "" producing countries "", "" in "",.year),"
"0","      subtitle = ""Terra-Watthours (TWh)"","
"0","      x= NULL,"
"0","      y = NULL"
"0","    )+"
"0","    theme("
"0","      plot.title.position = ""plot"","
"0","  #    plot.title = element_textbox_simple(size=16),"
"0","      axis.title.y = element_text(angle = 0, vjust = 0.5,size=14),"
"0","      axis.text = element_text(size=12),"
"0","      legend.position = ""none"") +"
"0","    NULL"
"0","}"
"0",""
"0","top_fuel(""gas"", 2018, 20)"
