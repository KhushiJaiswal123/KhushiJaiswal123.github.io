"0","#| message: false"
"0","#| warning: false"
"0","library(viridis)"
"0","library(patchwork)"
"0","library(ggrepel)"
"0",""
"0","energy_mix_co2_gdp <- function(country) {"
"0","  "
"0","  plot1 <- energy |> "
"0","    select(1:2, 6:14) |> # we will now have 11 columns"
"0","    pivot_longer(cols = 3:11,"
"0","                 names_to = ""source"","
"0","                 values_to = ""value"") |> "
"0","    "
"0","    filter(country == {{country}}, year >= 2000) |> "
"0","    drop_na(value) |> "
"0","    mutate(source = fct_reorder(source, value, max)) |> "
"0",""
"0","    "
"0","    "
"0","    ggplot()+"
"0","    aes(x=year, y = value, fill=source )+"
"0","    geom_area(color=""grey90"", "
"0","              alpha = 0.5,"
"0","              position = ""fill"")+ # so you get to 100%"
"0","    theme_bw()+"
"0","    scale_fill_viridis(discrete = T,"
"0","                       option = ""H"") +"
"0","    scale_y_continuous(labels = scales::percent)+"
"0","    labs(title = glue::glue(""Electricity Production Mix for "", {{country}}),"
"0","         x=NULL,"
"0","         y=NULL,"
"0","         fill= ""Source"")"
"0","  "
"0","  plot2 <- join2 |> "
"0","    select(year, country, GDPpercap, co2_per_capita, per_capita_electricity) |> "
"0","    filter(country == {{country}}, year >= 2000) |> "
"0","    "
"0","    ggplot()+"
"0","    aes(x=GDPpercap, y=co2_per_capita, label=year)+"
"0","    geom_point()+"
"0","    geom_text_repel(size=3)+"
"0","    theme_light() +"
"0","    scale_x_continuous(labels = scales::dollar)+"
"0","    labs(title = ""CO2 vs GDP per capita"","
"0","         subtitle = ""Greenhouse emissions in tonnes of CO2-equivalents per person"","
"0","         x = ""GDP per capita"","
"0","         y = ""CO2 emissions"")"
"0","  "
"0","  plot3 <- join2 |> "
"0","    select(year, country, GDPpercap, co2_per_capita, per_capita_electricity) |> "
"0","    filter(country == {{country}}, year >= 2000) |> "
"0","    "
"0","    ggplot()+"
"0","    aes(x=per_capita_electricity/365, y=co2_per_capita, label=year)+"
"0","    geom_point()+"
"0","    geom_text_repel(size=3)+"
"0","    theme_light()+"
"0","    labs(title = ""CO2 emissions vs per capita electricity consumption"","
"0","         x = ""Daily Electricity usage (kWh)"","
"0","         y = NULL)"
"0","  "
"0","  "
"0","# use patchwork to arrange plots"
"0","plot1 / (plot2 + plot3)"
"0","}"
"0",""
"0","energy_mix_co2_gdp(""India"")"
