"0",""
"0","### Linear Model"
"0","# Fit a linear model to predict house prices"
"0","lm_model <- lm(price ~ property_type + total_floor_area + number_habitable_rooms + average_income + london_zone + energy_consumption_current + co2_emissions_current, data = training_data)"
"0",""
"0","# Summarize the linear model"
"0","summary(lm_model)"
"1","
Call:
"
"1",""
"1","lm(formula = price ~ property_type + total_floor_area + number_habitable_rooms + 
    average_income + london_zone + energy_consumption_current + 
    co2_emissions_current, data = training_data)"
"1",""
"1","

"
"1",""
"1","Residuals:
"
"1","     Min "
"1","      1Q "
"1","  Median "
"1","      3Q "
"1","     Max "
"1","
"
"1","-1858449 "
"1"," -130620 "
"1","  -11245 "
"1","  103054 "
"1"," 7178065 "
"1","
"
"1","
Coefficients:
"
"1","                          "
"1","   Estimate"
"1"," Std. Error"
"1"," t value"
"1"," Pr(>|t|)"
"1","    "
"1","
(Intercept)               "
"1"," -2.754e+05"
"1","  3.908e+04"
"1","  -7.047"
"1"," 1.94e-12"
"1"," ***"
"1","
property_typeF            "
"1","  8.480e+04"
"1","  1.844e+04"
"1","   4.598"
"1"," 4.32e-06"
"1"," ***"
"1","
property_typeS            "
"1","  6.075e+04"
"1","  1.601e+04"
"1","   3.794"
"1"," 0.000149"
"1"," ***"
"1","
property_typeT            "
"1","  9.946e+04"
"1","  1.601e+04"
"1","   6.213"
"1"," 5.40e-10"
"1"," ***"
"1","
total_floor_area          "
"1","  9.497e+03"
"1","  2.059e+02"
"1","  46.133"
"1","  < 2e-16"
"1"," ***"
"1","
number_habitable_rooms    "
"1"," -5.604e+04"
"1","  4.049e+03"
"1"," -13.839"
"1","  < 2e-16"
"1"," ***"
"1","
average_income            "
"1","  7.946e+00"
"1","  4.088e-01"
"1","  19.439"
"1","  < 2e-16"
"1"," ***"
"1","
london_zone               "
"1"," -9.379e+04"
"1","  2.653e+03"
"1"," -35.344"
"1","  < 2e-16"
"1"," ***"
"1","
energy_consumption_current"
"1","  1.408e+02"
"1","  6.584e+01"
"1","   2.139"
"1"," 0.032497"
"1"," *  "
"1","
co2_emissions_current     "
"1","  6.799e+03"
"1","  3.908e+03"
"1","   1.740"
"1"," 0.081894"
"1"," .  "
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
Residual standard error:"
"1"," "
"1","338200"
"1"," "
"1","on"
"1"," "
"1","10488"
"1"," "
"1","degrees of freedom"
"1","
"
"1","Multiple R-squared: "
"1"," "
"1","0.6025"
"1",",	Adjusted R-squared: "
"1"," "
"1","0.6021"
"1"," "
"1","
F-statistic:"
"1"," "
"1"," 1766"
"1"," "
"1","on"
"1"," "
"1","9"
"1"," "
"1","and"
"1"," "
"1","10488"
"1"," "
"1","DF,  p-value:"
"1"," "
"1","< 2.2e-16"
"1","
"
"1","
"
"0","# Predict on the testing data (testing set)"
"0","testing_data <- testing_data %>%"
"0","  mutate(predicted_price_lm = predict(lm_model, newdata = testing_data))  # 只针对 `testing_data`"
"0",""
"0","# Evaluate the linear model on testing data"
"0","lm_rmse <- sqrt(mean((testing_data$price - testing_data$predicted_price_lm)^2, na.rm = TRUE))"
"0","lm_r2 <- cor(testing_data$price, testing_data$predicted_price_lm, use = ""complete.obs"")^2"
"0",""
"0","lm_performance <- data.frame("
"0","  RMSE = lm_rmse,"
"0","  R2 = lm_r2"
"0",")"
"0","print(lm_performance)"
